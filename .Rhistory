alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7)
## Grab the legend to use seperately
legend <- get_legend(plt_main)
plt_main <- plt_main + ggplot2::theme(legend.position = "none")
plts[[1]] <- plt_main
## SSC-H vs SSC-A
plt_single <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = log10(`SSC-H`), y = log10(`SSC-A`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7) +
ggplot2::theme(legend.position = "none")
plts[[2]] <- plt_single
other.plts <- list()
for(i in 1:length(plt_filters)){
filt <- plt_filters[i]
plts[[i+2]] <- ggplot2::ggplot() +
ggplot2::geom_area(data = as.data.frame(flow_frame[, filt]@exprs),
ggplot2::aes(x = log10(flow_frame[, filt]@exprs), y = ..count.., fill = "all_data"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(bacteria_flow_frame[, filt]@exprs),
ggplot2::aes(x = bacteria_flow_frame[, filt]@exprs, y = ..count.., fill = "bacteria"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(singlet_flow_frame[, filt]@exprs),
ggplot2::aes(x = singlet_flow_frame[, filt]@exprs, y = ..count.., fill = "single_bacteria"),
alpha = 0.5,
stat = "bin") +
xlab(filt) +
ylab("") +
ggplot2::xlim(0, 7) +
ggplot2::theme(legend.position = "none")
}
plts
gridExtra::arrangeGrob(grobs=plts)
plt_filters[1]
plt <- gridExtra::arrangeGrob(grobs=plts, ncol=2)
title <- grid::textGrob(paste("Trimming of flow data to remove background
and doublets:\n ",
flowCore::identifier(flow_frame)))
padding <- grid::unit(5, "mm")
plt <- gtable::gtable_add_rows(plt,
heights = grid::grobHeight(title) + padding,
pos = 0)
plt <- gtable::gtable_add_grob(plt, title, 1, 1, 1, ncol(plt))
plt <- plt + apatheme
plt
plt <- gridExtra::arrangeGrob(grobs=plts, ncol=2)
plt
title <- grid::textGrob(paste("Trimming of flow data to remove background
and doublets:\n ",
flowCore::identifier(flow_frame)))
padding <- grid::unit(5, "mm")
plt <- gtable::gtable_add_rows(plt,
heights = grid::grobHeight(title) + padding,
pos = 0)
plt <- gtable::gtable_add_grob(plt, title, 1, 1, 1, ncol(plt))
plt
print(plt)
ggplot2::ggsave(filename = paste(dirname(out_name),
gsub(".fcs",
"_trimmed.png",
basename(out_name)),
sep = "/"), plot = plt)
out_name <- paste(dirname(next_fcs),
"_trimmed/",
basename(next_fcs),
sep = "")
ggplot2::ggsave(filename = paste(dirname(out_name),
gsub(".fcs",
"_trimmed.png",
basename(out_name)),
sep = "/"), plot = plt)
plt + apatheme
plts <- list()
## FSC-H vs SSC-H
plt_main <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = log10(`FSC-H`), y = log10(`SSC-H`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7) + apatheme
## Grab the legend to use seperately
legend <- get_legend(plt_main)
plt_main <- plt_main + ggplot2::theme(legend.position = "none")
plts[[1]] <- plt_main
## SSC-H vs SSC-A
plt_single <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = log10(`SSC-H`), y = log10(`SSC-A`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7) +
ggplot2::theme(legend.position = "none") + apatheme
plts[[2]] <- plt_single
other.plts <- list()
for(i in 1:length(plt_filters)){
filt <- plt_filters[i]
plts[[i+2]] <- ggplot2::ggplot() +
ggplot2::geom_area(data = as.data.frame(flow_frame[, filt]@exprs),
ggplot2::aes(x = log10(flow_frame[, filt]@exprs), y = ..count.., fill = "all_data"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(bacteria_flow_frame[, filt]@exprs),
ggplot2::aes(x = bacteria_flow_frame[, filt]@exprs, y = ..count.., fill = "bacteria"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(singlet_flow_frame[, filt]@exprs),
ggplot2::aes(x = singlet_flow_frame[, filt]@exprs, y = ..count.., fill = "single_bacteria"),
alpha = 0.5,
stat = "bin") +
xlab(filt) +
ylab("") +
ggplot2::xlim(0, 7) +
ggplot2::theme(legend.position = "none") + apatheme
}
#       plt <- gridExtra::arrangeGrob(plt_main, plt_single, legend, plt_ssch,
#                          plt_bl1h, plt_yl1h, ncol = 3, nrow = 2)
#       plt <- gridExtra::arrangeGrob(plt_main, plt_single, legend,
#                                     plt_vl1h, plt_vl2h, plt_bl1h,
#                                     plt_bl2h, plt_yl1h, plt_yl2h,
#                                     ncol = 3, nrow = 3)
# plts <- list(plt_main, plt_single, other.plts, legend)
plt <- gridExtra::arrangeGrob(grobs=plts, ncol=2)
title <- grid::textGrob(paste("Trimming of flow data to remove background
and doublets:\n ",
flowCore::identifier(flow_frame)))
padding <- grid::unit(5, "mm")
plt <- gtable::gtable_add_rows(plt,
heights = grid::grobHeight(title) + padding,
pos = 0)
plt <- gtable::gtable_add_grob(plt, title, 1, 1, 1, ncol(plt))
ggplot2::ggsave(filename = paste(dirname(out_name),
gsub(".fcs",
"_trimmed.png",
basename(out_name)),
sep = "/"), plot = plt)
plts <- list()
## FSC-H vs SSC-H
plt_main <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = log10(`FSC-H`), y = log10(`SSC-H`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7) + apatheme
## Grab the legend to use seperately
legend <- get_legend(plt_main)
plt_main <- plt_main + ggplot2::theme(legend.position = "none")
plts[[1]] <- plt_main
## SSC-H vs SSC-A
plt_single <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = log10(`SSC-H`), y = log10(`SSC-A`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7)  + apatheme +
ggplot2::theme(legend.position = "none")
plts[[2]] <- plt_single
other.plts <- list()
for(i in 1:length(plt_filters)){
filt <- plt_filters[i]
plts[[i+2]] <- ggplot2::ggplot() +
ggplot2::geom_area(data = as.data.frame(flow_frame[, filt]@exprs),
ggplot2::aes(x = log10(flow_frame[, filt]@exprs), y = ..count.., fill = "all_data"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(bacteria_flow_frame[, filt]@exprs),
ggplot2::aes(x = bacteria_flow_frame[, filt]@exprs, y = ..count.., fill = "bacteria"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(singlet_flow_frame[, filt]@exprs),
ggplot2::aes(x = singlet_flow_frame[, filt]@exprs, y = ..count.., fill = "single_bacteria"),
alpha = 0.5,
stat = "bin") +
xlab(filt) +
ylab("") +
ggplot2::xlim(0, 7)  + apatheme +
ggplot2::theme(legend.position = "none")
}
#       plt <- gridExtra::arrangeGrob(plt_main, plt_single, legend, plt_ssch,
#                          plt_bl1h, plt_yl1h, ncol = 3, nrow = 2)
#       plt <- gridExtra::arrangeGrob(plt_main, plt_single, legend,
#                                     plt_vl1h, plt_vl2h, plt_bl1h,
#                                     plt_bl2h, plt_yl1h, plt_yl2h,
#                                     ncol = 3, nrow = 3)
# plts <- list(plt_main, plt_single, other.plts, legend)
plt <- gridExtra::arrangeGrob(grobs=plts, ncol=2)
title <- grid::textGrob(paste("Trimming of flow data to remove background
and doublets:\n ",
flowCore::identifier(flow_frame)))
padding <- grid::unit(5, "mm")
plt <- gtable::gtable_add_rows(plt,
heights = grid::grobHeight(title) + padding,
pos = 0)
plt <- gtable::gtable_add_grob(plt, title, 1, 1, 1, ncol(plt))
ggplot2::ggsave(filename = paste(dirname(out_name),
gsub(".fcs",
"_trimmed.png",
basename(out_name)),
sep = "/"), plot = plt)
plts[[3+length(plt_filters)]] <- legend
plt <- gridExtra::arrangeGrob(grobs=plts, ncol=2)
title <- grid::textGrob(paste("Trimming of flow data to remove background
and doublets:\n ",
flowCore::identifier(flow_frame)))
padding <- grid::unit(5, "mm")
plt <- gtable::gtable_add_rows(plt,
heights = grid::grobHeight(title) + padding,
pos = 0)
plt <- gtable::gtable_add_grob(plt, title, 1, 1, 1, ncol(plt))
ggplot2::ggsave(filename = paste(dirname(out_name),
gsub(".fcs",
"_trimmed.png",
basename(out_name)),
sep = "/"), plot = plt)
plts <- list()
## FSC-H vs SSC-H
plt_main <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = log10(`FSC-H`), y = log10(`SSC-H`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7) + apatheme
## Grab the legend to use seperately
legend <- get_legend(plt_main)
plt_main <- plt_main + ggplot2::theme(legend.position = "none")
plts[[1]] <- plt_main
## SSC-H vs SSC-A
plt_single <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = log10(`SSC-H`), y = log10(`SSC-A`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7)  + apatheme +
ggplot2::theme(legend.position = "none")
plts[[2]] <- plt_single
other.plts <- list()
for(i in 1:length(plt_filters)){
filt <- plt_filters[i]
plts[[i+2]] <- ggplot2::ggplot() +
ggplot2::geom_area(data = as.data.frame(flow_frame[, filt]@exprs),
ggplot2::aes(x = log10(flow_frame[, filt]@exprs), y = ..count.., fill = "all_data"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(bacteria_flow_frame[, filt]@exprs),
ggplot2::aes(x = bacteria_flow_frame[, filt]@exprs, y = ..count.., fill = "bacteria"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(singlet_flow_frame[, filt]@exprs),
ggplot2::aes(x = singlet_flow_frame[, filt]@exprs, y = ..count.., fill = "single_bacteria"),
alpha = 0.5,
stat = "bin") +
xlab(filt) +
ylab("") +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank())+
ggplot2::xlim(0, 7)  + apatheme +
ggplot2::theme(legend.position = "none")
}
#       plt <- gridExtra::arrangeGrob(plt_main, plt_single, legend, plt_ssch,
#                          plt_bl1h, plt_yl1h, ncol = 3, nrow = 2)
#       plt <- gridExtra::arrangeGrob(plt_main, plt_single, legend,
#                                     plt_vl1h, plt_vl2h, plt_bl1h,
#                                     plt_bl2h, plt_yl1h, plt_yl2h,
#                                     ncol = 3, nrow = 3)
# plts <- list(plt_main, plt_single, other.plts, legend)
plts[[3+length(plt_filters)]] <- legend
plt <- gridExtra::arrangeGrob(grobs=plts, ncol=2)
title <- grid::textGrob(paste("Trimming of flow data to remove background
and doublets:\n ",
flowCore::identifier(flow_frame)))
padding <- grid::unit(5, "mm")
plt <- gtable::gtable_add_rows(plt,
heights = grid::grobHeight(title) + padding,
pos = 0)
plt <- gtable::gtable_add_grob(plt, title, 1, 1, 1, ncol(plt))
ggplot2::ggsave(filename = paste(dirname(out_name),
gsub(".fcs",
"_trimmed.png",
basename(out_name)),
sep = "/"), plot = plt)
plts <- list()
## FSC-H vs SSC-H
plt_main <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = log10(`FSC-H`), y = log10(`SSC-H`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7) + apatheme
## Grab the legend to use seperately
legend <- get_legend(plt_main)
plt_main <- plt_main + ggplot2::theme(legend.position = "none")
plts[[1]] <- plt_main
## SSC-H vs SSC-A
plt_single <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = log10(`SSC-H`), y = log10(`SSC-A`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7)  + apatheme +
ggplot2::theme(legend.position = "none")
plts[[2]] <- plt_single
other.plts <- list()
for(i in 1:length(plt_filters)){
filt <- plt_filters[i]
plts[[i+2]] <- ggplot2::ggplot() +
ggplot2::geom_area(data = as.data.frame(flow_frame[, filt]@exprs),
ggplot2::aes(x = log10(flow_frame[, filt]@exprs), y = ..count.., fill = "all_data"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(bacteria_flow_frame[, filt]@exprs),
ggplot2::aes(x = bacteria_flow_frame[, filt]@exprs, y = ..count.., fill = "bacteria"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(singlet_flow_frame[, filt]@exprs),
ggplot2::aes(x = singlet_flow_frame[, filt]@exprs, y = ..count.., fill = "single_bacteria"),
alpha = 0.5,
stat = "bin") +
xlab(filt) +
ylab("") +
ggplot2::xlim(0, 7)  + apatheme +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank())+
ggplot2::theme(legend.position = "none")
}
#       plt <- gridExtra::arrangeGrob(plt_main, plt_single, legend, plt_ssch,
#                          plt_bl1h, plt_yl1h, ncol = 3, nrow = 2)
#       plt <- gridExtra::arrangeGrob(plt_main, plt_single, legend,
#                                     plt_vl1h, plt_vl2h, plt_bl1h,
#                                     plt_bl2h, plt_yl1h, plt_yl2h,
#                                     ncol = 3, nrow = 3)
# plts <- list(plt_main, plt_single, other.plts, legend)
plts[[3+length(plt_filters)]] <- legend
plt <- gridExtra::arrangeGrob(grobs=plts, ncol=2)
title <- grid::textGrob(paste("Trimming of flow data to remove background
and doublets:\n ",
flowCore::identifier(flow_frame)))
padding <- grid::unit(5, "mm")
plt <- gtable::gtable_add_rows(plt,
heights = grid::grobHeight(title) + padding,
pos = 0)
plt <- gtable::gtable_add_grob(plt, title, 1, 1, 1, ncol(plt))
ggplot2::ggsave(filename = paste(dirname(out_name),
gsub(".fcs",
"_trimmed.png",
basename(out_name)),
sep = "/"), plot = plt)
plt_filters <- c("BL1-H")
plts <- list()
## FSC-H vs SSC-H
plt_main <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = log10(`FSC-H`), y = log10(`SSC-H`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("FSC-H", "SSC-H")]@exprs),
ggplot2::aes(x = `FSC-H`, y = `SSC-H`, color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7) + apatheme
## Grab the legend to use seperately
legend <- get_legend(plt_main)
plt_main <- plt_main + ggplot2::theme(legend.position = "none")
plts[[1]] <- plt_main
## SSC-H vs SSC-A
plt_single <- ggplot2::ggplot() +
ggplot2::geom_point(data = as.data.frame(flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = log10(`SSC-H`), y = log10(`SSC-A`), color = "all_data"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(bacteria_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "bacteria"),
alpha = 0.1) +
ggplot2::geom_point(data = as.data.frame(singlet_flow_frame[, c("SSC-H", "SSC-A")]@exprs),
ggplot2::aes(x = `SSC-H`, y = (`SSC-A`), color = "single_bacteria"),
alpha = 0.1) +
ggplot2::xlim(0, 7) +
ggplot2::ylim(0, 7)  + apatheme +
ggplot2::theme(legend.position = "none")
plts[[2]] <- plt_single
other.plts <- list()
for(i in 1:length(plt_filters)){
filt <- plt_filters[i]
plts[[i+2]] <- ggplot2::ggplot() +
ggplot2::geom_area(data = as.data.frame(flow_frame[, filt]@exprs),
ggplot2::aes(x = log10(flow_frame[, filt]@exprs), y = ..count.., fill = "all_data"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(bacteria_flow_frame[, filt]@exprs),
ggplot2::aes(x = bacteria_flow_frame[, filt]@exprs, y = ..count.., fill = "bacteria"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_area(data = as.data.frame(singlet_flow_frame[, filt]@exprs),
ggplot2::aes(x = singlet_flow_frame[, filt]@exprs, y = ..count.., fill = "single_bacteria"),
alpha = 0.5,
stat = "bin") +
xlab(filt) +
ylab("") +
ggplot2::xlim(0, 7)  + apatheme +
theme(axis.text.y = element_blank(), axis.ticks.y = element_blank())+
ggplot2::theme(legend.position = "none")
}
plts[[3+length(plt_filters)]] <- legend
plt <- gridExtra::arrangeGrob(grobs=plts, ncol=2)
title <- grid::textGrob(paste("Trimming of flow data to remove background
and doublets:\n ",
flowCore::identifier(flow_frame)))
padding <- grid::unit(5, "mm")
plt <- gtable::gtable_add_rows(plt,
heights = grid::grobHeight(title) + padding,
pos = 0)
plt <- gtable::gtable_add_grob(plt, title, 1, 1, 1, ncol(plt))
ggplot2::ggsave(filename = paste(dirname(out_name),
gsub(".fcs",
"_trimmed.png",
basename(out_name)),
sep = "/"), plot = plt)
install.packages("roxygen2")
ggplot2::ggplot() +
ggplot2::geom_density(data = as.data.frame(flow_frame[, filt]@exprs),
ggplot2::aes(x = log10(flow_frame[, filt]@exprs), y = ..count.., fill = "all_data"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_density(data = as.data.frame(bacteria_flow_frame[, filt]@exprs),
ggplot2::aes(x = bacteria_flow_frame[, filt]@exprs, y = ..count.., fill = "bacteria"),
alpha = 0.5,
stat = "bin") +
ggplot2::geom_density(data = as.data.frame(singlet_flow_frame[, filt]@exprs),
ggplot2::aes(x = singlet_flow_frame[, filt]@exprs, y = ..count.., fill = "single_bacteria"),
alpha = 0.5,
stat = "bin") +
ggplot2::xlab(filt) +
ggplot2::ylab("") +
ggplot2::xlim(0, 7)  + apatheme +
ggplot2::theme(axis.text.y = ggplot2::element_blank(), axis.ticks.y = ggplot2::element_blank())+
ggplot2::theme(legend.position = "none")
ggplot2::ggplot() +
ggplot2::geom_density(data = as.data.frame(flow_frame[, filt]@exprs),
ggplot2::aes(x = log10(flow_frame[, filt]@exprs), y = ..count.., fill = "all_data"),
alpha = 0.5) +
ggplot2::geom_density(data = as.data.frame(bacteria_flow_frame[, filt]@exprs),
ggplot2::aes(x = bacteria_flow_frame[, filt]@exprs, y = ..count.., fill = "bacteria"),
alpha = 0.5) +
ggplot2::geom_density(data = as.data.frame(singlet_flow_frame[, filt]@exprs),
ggplot2::aes(x = singlet_flow_frame[, filt]@exprs, y = ..count.., fill = "single_bacteria"),
alpha = 0.5) +
ggplot2::xlab(filt) +
ggplot2::ylab("") +
ggplot2::xlim(0, 7)  + apatheme +
ggplot2::theme(axis.text.y = ggplot2::element_blank(), axis.ticks.y = ggplot2::element_blank())+
ggplot2::theme(legend.position = "none")
library(autoGate)
trim.fcs("R:/Alex/FACS/test", do_plot = T, plt_filters = c("BL1-H"))
trim.fcs("R:/Alex/FACS/test", do_plot = T, plt_filters = c("BL1-H"))
trim.fcs("R:/Alex/FACS/test", do_plot = T, plt_filters = c("BL1-H"))
